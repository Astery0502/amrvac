!==============================================================
! Project : 2.5D MHD solar atmosphere in bipolar magnetic field
! Aim     : serve as a basic model for solar applications
! Results :
! Update  : 13/09/2016
! configuration :
! $AMRVAC_DIR/setup.pl -d=23 -phi=0 -z=0 -p=mhd
!==============================================================

 &filelist
        base_filename='solar_atm'
        typefilelog='regression_test'
        primnames='rho v1 v2 v3 p b1 b2 b3'
        saveprim=.true.
        autoconvert=.true.
        convert_type='vtuBCCmpi'
        nwauxio=9
 /
        restart_from_file='solar_atm_25D'
        snapshotini=0
        snapshotnext=1
        convert=.true.

 &savelist
        !itsave(1,1)=0
        !itsave(1,2)=0
        !ditsave=1,50
        ditsave_log = 1
 /
        dtsave=0.1d0,2.d0

 &stoplist
        dtmin=1.D-7
        itmax=100
 /
        time_max=80.d0
        itreset=.true.
        time_reset=.true.

 &methodlist
        w_names=       'rho m1 m2 m3 e b1 b2 b3'
        time_integrator=  'threestep'
        flux_scheme=    20*'hll'
        limiter= 20*'cada3'
        typelimited='predictor'
        dimsplit=.false.
        ssplitdivb=.true.
        typedivbfix='linde'
        strictsmall=.true.
        strictgetaux=.false.
        nflatgetaux=2
        small_pressure=1.0d-8
        small_density=1.0d-14
 /

 &boundlist
        nghostcells=    2
        typeboundary_min1 = 'symm','asymm','symm','asymm','symm','asymm','symm','asymm'
        typeboundary_max1 = 'symm','asymm','symm','asymm','symm','asymm','symm','asymm'
        typeboundary_min2 = 8*'special'
        typeboundary_max2 = 8*'special'
 /

 &meshlist
        refine_criterion=3
        refine_max_level=4
        refine_threshold=20*0.2d0
        derefine_ratio=20*0.15d0
        w_for_refine(9)=4
        w_for_refine(1)=1
        w_for_refine(2)=6
        w_for_refine(3)=7
        w_for_refine(4)=8
        w_refine_weight(1)=0.4d0
        w_refine_weight(2)=0.2d0
        w_refine_weight(3)=0.2d0
        w_refine_weight(4)=0.2d0
        block_nx1=12
        block_nx2=12
        domain_nx1=96
        domain_nx2=96
        iprob=1
        xprobmin1=-3.d0
        xprobmax1=3.d0
        xprobmin2=0.d0
        xprobmax2=6.d0
        ditregrid=3
 /

 &paramlist
        typecourant='maxsum'
        courantpar=0.8d0
 /
 &mhd_list
  mhd_thermal_conduction=.true.
  mhd_radiative_cooling=.true.
 /
